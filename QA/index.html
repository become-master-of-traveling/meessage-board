<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8" />
    <title>æ—…éŠç•™è¨€ç‰† Sticky Notes Wall</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- é¦–é é¸å–® -->
<div id="menu" class="menu">
    <h1>æ—…éŠç•™è¨€ç‰†</h1>
    <button onclick="showWall()">æŸ¥çœ‹ç•™è¨€ç‰†</button>
    <button onclick="showInput()">æˆ‘è¦ç•™è¨€</button>
</div>

<!-- ç•™è¨€è¼¸å…¥å€ -->
<div id="inputPage" class="hidden">
    <h1 class="title">æˆ‘è¦ç•™è¨€</h1>
    <button class="back" onclick="showMenu()">è¿”å›é¸å–®</button>
    <button class="wallPage" onclick="showWall()">ç•™è¨€ç‰†</button>

    <div class="input-box">
        <input id="name" type="text" placeholder="ä½ çš„åå­—ï¼ˆä¾‹å¦‚ï¼šAmyã€Huixinã€Chiuï¼‰" />
        <textarea id="content" placeholder="æƒ³èªªäº›ä»€éº¼å‘¢ï¼Ÿ" rows="3"></textarea>
        <button onclick="addMessage()">é€å‡ºç•™è¨€</button>
    </div>
</div>

<!-- ç•™è¨€ç‰† -->
<div id="wallPage" class="hidden">
    <h1 class="title">ç•™è¨€ç‰†</h1>
    <button class="back" onclick="showMenu()">è¿”å›é¸å–®</button>
    <button class="inputPage" onclick="showInput()">ç•™è¨€å€</button>

    <div id="messages"></div>
</div>


<script>
// --------------------- åˆ‡æ›é é¢åŠŸèƒ½ ----------------------

function showMenu() {
    document.getElementById("menu").classList.remove("hidden");
    document.getElementById("inputPage").classList.add("hidden");
    document.getElementById("wallPage").classList.add("hidden");
}

function showInput() {
    document.getElementById("menu").classList.add("hidden");
    document.getElementById("inputPage").classList.remove("hidden");
    document.getElementById("wallPage").classList.add("hidden");
}

function showWall() {
    document.getElementById("menu").classList.add("hidden");
    document.getElementById("inputPage").classList.add("hidden");
    document.getElementById("wallPage").classList.remove("hidden");
    render();
}


// --------------------- ç•™è¨€åŠŸèƒ½ ----------------------

let messages = JSON.parse(localStorage.getItem("messages") || "[]");

function save() {
    localStorage.setItem("messages", JSON.stringify(messages));
}

function addMessage() {
    const name = document.getElementById("name").value.trim();
    const content = document.getElementById("content").value.trim();

    if (!name || !content) return alert("è«‹è¼¸å…¥åå­—èˆ‡ç•™è¨€å…§å®¹ï¼");

    messages.push({
        name,
        content,
        time: new Date().toLocaleString(),
        likes: 0,
        replies: []
    });

    save();
    render();

    // æ¸…ç©ºè¼¸å…¥æ¡†
    document.getElementById("content").value = "";

    alert("ç•™è¨€æˆåŠŸï¼");
}

function likeMessage(index) {
    messages[index].likes++;
    save();
    render();
}

function deleteMessage(index) {
    if (confirm("ç¢ºå®šè¦åˆªé™¤é€™å‰‡ç•™è¨€å—ï¼Ÿ")) {
        messages.splice(index, 1);
        save();
        render();
    }
}

function addReply(index) {
    const reply = prompt("è¼¸å…¥å›è¦†å…§å®¹ï¼š");
    if (!reply) return;

    messages[index].replies.push(reply);
    save();
    render();
}

// --------------------- é¡¯ç¤ºç•™è¨€ç‰† ----------------------

function render() {
    const box = document.getElementById("messages");
    box.innerHTML = "";

    const colors = ["var(--sticky1)", "var(--sticky2)", "var(--sticky3)", "var(--sticky4)", "var(--sticky5)"];

    messages.forEach((msg, i) => {
        const bg = colors[Math.floor(Math.random() * colors.length)];
        const rotate = Math.floor(Math.random() * 11) - 5;

        box.innerHTML += `
        <div class="message" style="background:${bg}; --rotate:${rotate}">
            <strong>${msg.name}</strong>
            <div class="time">${msg.time}</div>
            <div class="content">${msg.content}</div>

            <div class="actions">
                <span class="like" onclick="likeMessage(${i})">â¤ï¸ ${msg.likes}</span>
                <span class="reply-btn" onclick="addReply(${i})">ğŸ’­ å›è¦†</span>
                <span class="delete-btn" onclick="deleteMessage(${i})">ğŸ—‘ï¸ åˆªé™¤</span>
            </div>

            ${msg.replies.map(r => `<div class="reply-box">ğŸ’¬ ${r}</div>`).join("")}
        </div>`;
    });
}

</script>

</body>
</html>
